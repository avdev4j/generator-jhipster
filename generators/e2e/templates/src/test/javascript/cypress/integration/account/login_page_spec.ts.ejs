describe('/login', () => {

    beforeEach(() => {
        cy.visit('/login');
    })

    it('greets with signin', () => {
        // TODO add translation support here.
        cy.contains('h5', 'Sign in');
    });

    it('links to /register', () => {
        cy.contains('Register a new account')
            .should('have.attr', 'href', '/account/register');
    });

    it('links to /account/reset/password', () => {
        cy.contains('Did you forget your password?')
            .should('have.attr', 'href', '/account/reset/request');
    });

    it('requires username', () => {
        cy.get('button').contains('Sign in').click();
        cy.get('#username').should('have.class', 'is-invalid');
    });

    it('requires password', () => {
        cy.login('admin', '');
        cy.get('#username').should('not.have.class', 'is-invalid');
        cy.get('#password').should('have.class', 'is-invalid');
        cy.get('.alert-danger').contains('Failed to sign in!');
    });

    it('errors when password is incorrect', () => {
        cy.login('admin', 'bad-password');
        // TODO add translation support here.
        cy.get('.alert-danger').contains('Failed to sign in!');
    });

    it('go to login page when successfully logs in', () => {
        cy.login('admin', 'admin');
        cy.logout();
    });
});